<h2>Products</h2>

<a href="{% url 'product_create' %}">+ Add Product</a>

<hr>

{% if not products %}
    <p>No products added yet.</p>
{% endif %}

<ul>
{% for p in products %}
    <li style="margin-bottom: 30px;">
        <h3>{{ p.name }}</h3>

        {% if p.image %}
            <img
                src="{{ p.image.url }}"
                alt="{{ p.name }}"
                style="width:120px;height:auto;border:1px solid #ccc;"
            >
        {% else %}
            <p><em>No product image</em></p>
        {% endif %}

        <p><strong>Brand:</strong> {{ p.brand|default:"-" }}</p>
        <p><strong>Description:</strong> {{ p.description|default:"-" }}</p>

        <form method="post" action="{% url 'product_delete' p.slug %}" style="display:inline;">
            {% csrf_token %}
            <button type="submit">Delete Product</button>
        </form>

        <h4>Variants</h4>

        {% if not p.variants.all %}
            <p>No variants added</p>
        {% endif %}

        <ul>
        {% for v in p.variants.all %}
            <li style="margin-bottom: 15px;">
                <strong>{{ v.variant_name }}</strong>

                {% if v.image %}
                    <br>
                    <img
                        src="{{ v.image.url }}"
                        alt="{{ v.variant_name }}"
                        style="width:80px;height:auto;border:1px solid #ccc;"
                    >
                {% else %}
                    <br>
                    <em>No variant image</em>
                {% endif %}

                <br>
                SKU: {{ v.sku|default:"-" }} |
                Barcode: {{ v.barcode|default:"-" }}

                <form
                    method="post"
                    action="{% url 'variant_delete' v.slug %}"
                    style="display:inline;"
                >
                    {% csrf_token %}
                    <button type="submit">Delete Variant</button>
                </form>
            </li>
        {% endfor %}
        </ul>

        <a href="{% url 'variant_create' p.slug %}">+ Add Variant</a>
    </li>
{% endfor %}
</ul>
